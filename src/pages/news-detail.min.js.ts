import { SlugDto } from '@/dtos/Slug.dto';

function generateSiteMap() {
  return `
        function onToc(){
             if($(".toc-list").length)
            {
                $(".toc-list").toc({
                    content: "div#toc-content",
                    headings: "h2,h3,h4"
                });
        
                if(!$(".toc-list li").length) $(".meta-toc").hide();
        
                $('.toc-list').find('a').click(function(){
                    let x = $(this).data('rel');
                    goToByScroll(x);
                });
            }
        }
        function goToByScroll(id)
        {
            let offsetMenu = 0;
            id = id.replace("#", "");
            if($("#header").length) offsetMenu = $("#header").height();
            $('html,body').animate({
                scrollTop: $("#" + id).offset().top - (offsetMenu * 2)
            }, 'slow');
        }
        $(document).ready(function(){
            onToc();
            window.onToc = onToc;
        });
    `;
}

export async function getServerSideProps({ res }: any) {
  const sitemap = generateSiteMap();

  res.setHeader('Content-Type', 'text/javascript');
  // we send the XML to the browser
  res.write(sitemap);
  res.end();

  return {
    props: {},
  };
}

function SiteMap() {
  // getServerSideProps will do the heavy lifting
}

export default SiteMap;
